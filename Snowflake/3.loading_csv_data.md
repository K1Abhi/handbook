> **Note:** Querying **file metadata** in a stage does **not require a warehouse**, but querying **table data** in Snowflake **does require a warehouse**.

## 📥 Loading CSV into Snowflake ❄️

CSV files from your local system can be uploaded to Snowflake by first loading them into a **stage**.

### 🗂️ Types of Stages

1. **Internal Stages**:
   - **Named Stage**: Created explicitly by the user (`CREATE STAGE mystage`)
   - **User Stage**: Automatically created for each Snowflake user
   - **Table Stage**: Associated with each table

2. **External Stages**:
   - Integration with cloud storage like **AWS S3**, **Google Cloud Storage**, or **Azure Blob Storage**

---

### 📦 Example: Using an Internal Stage

```sql
-- Create a named internal stage
CREATE STAGE mystage;

-- List files uploaded to the stage
LIST @mystage;

we can query the contents and metadata of a staged file directly
```sql
SELECT metadata$file_row_number, $1, $2
FROM @mystage/emp.csv;
```

### 🧾 What This Query Does

- **`@mystage/emp.csv`**  
  Refers to the `emp.csv` file stored in the `mystage` stage. The `@` symbol indicates a reference to a stage.

- **`$1`, `$2`**  
  Positional column references used when querying structured files like CSVs without a defined schema:  
  - `$1` = First column in the file  
  - `$2` = Second column in the file

- **`metadata$file_row_number`**  
  A special Snowflake **metadata column** that returns the **row number** of the current record in the file. Useful for debugging or auditing file contents.

---

### 📤 Query Output

The query will return:
1. The **row number** from the CSV file  
2. The **first column** value  
3. The **second column** value

